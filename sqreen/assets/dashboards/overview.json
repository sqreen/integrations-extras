{
    "title": "Sqreen - Overview",
    "description": "",
    "widgets": [
        {
            "id": 2090187385864486,
            "layout": {
                "x": 21,
                "y": 29,
                "width": 47,
                "height": 26
            },
            "definition": {
                "title": "Top 5 Anonymous Attackers (IP)",
                "title_size": "16",
                "title_align": "left",
                "type": "toplist",
                "requests": [
                    {
                        "log_query": {
                            "index": "*",
                            "search": {
                                "query": "source:sqreen @sqreen.signal_name:(sq.backend.waf OR sq.backend.rasp)"
                            },
                            "group_by": [
                                {
                                    "facet": "@sqreen.actor.ip.address",
                                    "sort": {
                                        "order": "desc",
                                        "aggregation": "count"
                                    },
                                    "limit": 5
                                }
                            ],
                            "compute": {
                                "aggregation": "count"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": 7367940905862240,
            "layout": {
                "x": 21,
                "y": 4,
                "width": 47,
                "height": 24
            },
            "definition": {
                "title": "Top 5 Authenticated Attackers",
                "title_size": "16",
                "title_align": "left",
                "type": "toplist",
                "requests": [
                    {
                        "log_query": {
                            "index": "*",
                            "search": {
                                "query": "source:sqreen @sqreen.signal_name:(sq.backend.waf OR sq.backend.rasp)"
                            },
                            "group_by": [
                                {
                                    "facet": "@sqreen.actor.identifier.username",
                                    "sort": {
                                        "order": "desc",
                                        "aggregation": "count"
                                    },
                                    "limit": 5
                                }
                            ],
                            "compute": {
                                "aggregation": "count"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": 3608531033802024,
            "layout": {
                "x": 118,
                "y": 50,
                "width": 77,
                "height": 21
            },
            "definition": {
                "title": "Attack performed by authenticated users",
                "title_size": "16",
                "title_align": "left",
                "show_legend": true,
                "legend_layout": "vertical",
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "type": "timeseries",
                "requests": [
                    {
                        "on_right_yaxis": false,
                        "log_query": {
                            "index": "*",
                            "search": {
                                "query": "@sqreen.actor.user.auth_id:* $actor $geo $env $service"
                            },
                            "group_by": [
                                {
                                    "facet": "@sqreen.payload.ruleset",
                                    "sort": {
                                        "order": "desc",
                                        "aggregation": "count"
                                    },
                                    "limit": 10
                                }
                            ],
                            "compute": {
                                "interval": 300000,
                                "aggregation": "count"
                            }
                        },
                        "style": {
                            "palette": "orange",
                            "line_type": "solid",
                            "line_width": "normal"
                        },
                        "display_type": "bars"
                    }
                ],
                "yaxis": {
                    "scale": "linear",
                    "label": "",
                    "include_zero": true,
                    "min": "auto",
                    "max": "auto"
                },
                "events": [
                    {
                        "q": "tags:service:$service.value"
                    }
                ],
                "markers": []
            }
        },
        {
            "id": 4616638083983688,
            "layout": {
                "x": 70,
                "y": 4,
                "width": 47,
                "height": 17
            },
            "definition": {
                "title": "Top 5 production services under attack",
                "title_size": "16",
                "title_align": "left",
                "type": "toplist",
                "requests": [
                    {
                        "log_query": {
                            "index": "*",
                            "search": {
                                "query": "source:sqreen @sqreen.signal_name:(sq.backend.waf OR sq.backend.rasp) env:production"
                            },
                            "group_by": [
                                {
                                    "facet": "service",
                                    "sort": {
                                        "order": "desc",
                                        "aggregation": "count"
                                    },
                                    "limit": 5
                                }
                            ],
                            "compute": {
                                "aggregation": "count"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": 5670733389571260,
            "layout": {
                "x": 0,
                "y": 13,
                "width": 19,
                "height": 12
            },
            "definition": {
                "title": "Total Requests Blocked",
                "title_size": "16",
                "title_align": "left",
                "type": "query_value",
                "requests": [
                    {
                        "conditional_formats": [
                            {
                                "comparator": ">=",
                                "palette": "white_on_red",
                                "value": 1000
                            },
                            {
                                "comparator": ">=",
                                "palette": "white_on_yellow",
                                "value": 100
                            },
                            {
                                "comparator": ">=",
                                "palette": "black_on_light_yellow",
                                "value": 10
                            },
                            {
                                "comparator": "<",
                                "palette": "yellow_on_white",
                                "value": 10
                            }
                        ],
                        "log_query": {
                            "index": "*",
                            "search": {
                                "query": "@sqreen.context.response.blocked:true"
                            },
                            "group_by": [],
                            "compute": {
                                "aggregation": "count"
                            }
                        }
                    }
                ],
                "autoscale": true,
                "custom_unit": "reqs",
                "precision": 2
            }
        },
        {
            "id": 5689005099439174,
            "layout": {
                "x": 70,
                "y": 22,
                "width": 47,
                "height": 42
            },
            "definition": {
                "title": "Top 25 production targeted paths",
                "title_size": "16",
                "title_align": "left",
                "type": "toplist",
                "requests": [
                    {
                        "log_query": {
                            "index": "*",
                            "search": {
                                "query": "source:sqreen env:production @sqreen.signal_name:(sq.backend.waf OR sq.backend.rasp)"
                            },
                            "group_by": [
                                {
                                    "facet": "@sqreen.context.request.path",
                                    "sort": {
                                        "order": "desc",
                                        "aggregation": "count"
                                    },
                                    "limit": 25
                                }
                            ],
                            "compute": {
                                "aggregation": "count"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": 686011885240556,
            "layout": {
                "x": 21,
                "y": 0,
                "width": 47,
                "height": 3
            },
            "definition": {
                "type": "free_text",
                "text": "ðŸ¥·ðŸ½ Attackers",
                "color": "#4d4d4d",
                "font_size": "36",
                "text_align": "left"
            }
        },
        {
            "id": 5457429555621360,
            "layout": {
                "x": 118,
                "y": 29,
                "width": 77,
                "height": 20
            },
            "definition": {
                "title": "Vulnerabilities exploited",
                "title_size": "16",
                "title_align": "left",
                "show_legend": true,
                "legend_layout": "vertical",
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "type": "timeseries",
                "requests": [
                    {
                        "on_right_yaxis": false,
                        "log_query": {
                            "index": "*",
                            "search": {
                                "query": "@sqreen.signal_name:sq.backend.rasp $env $service"
                            },
                            "group_by": [
                                {
                                    "facet": "@sqreen.payload.protection",
                                    "sort": {
                                        "order": "desc",
                                        "aggregation": "count"
                                    },
                                    "limit": 10
                                }
                            ],
                            "compute": {
                                "aggregation": "count"
                            }
                        },
                        "style": {
                            "palette": "warm",
                            "line_type": "solid",
                            "line_width": "normal"
                        },
                        "display_type": "bars"
                    }
                ],
                "yaxis": {
                    "scale": "linear",
                    "label": "",
                    "include_zero": true,
                    "min": "auto",
                    "max": "auto"
                },
                "markers": []
            }
        },
        {
            "id": 4332598140241696,
            "layout": {
                "x": 118,
                "y": 23,
                "width": 44,
                "height": 5
            },
            "definition": {
                "type": "note",
                "content": "[Review all incidents](https://my.sqreen.com/incidents?duration=2592000) (to Sqreen Dashboard)",
                "background_color": "blue",
                "font_size": "18",
                "text_align": "left",
                "vertical_align": "center",
                "show_tick": false,
                "tick_pos": "50%",
                "tick_edge": "left",
                "has_padding": true
            }
        },
        {
            "id": 7256186432074844,
            "layout": {
                "x": 0,
                "y": 0,
                "width": 12,
                "height": 12
            },
            "definition": {
                "type": "image",
                "url": "/static/images/sqreen_logo.svg",
                "sizing": "fit"
            }
        },
        {
            "id": 5142647697525248,
            "layout": {
                "x": 70,
                "y": 0,
                "width": 47,
                "height": 3
            },
            "definition": {
                "type": "free_text",
                "text": "ðŸ¤º  Services under attack",
                "color": "#4d4d4d",
                "font_size": "36",
                "text_align": "left"
            }
        },
        {
            "id": 5472002795742902,
            "layout": {
                "x": 118,
                "y": 0,
                "width": 76,
                "height": 3
            },
            "definition": {
                "type": "free_text",
                "text": "ðŸ“Š Security Activity",
                "color": "#4d4d4d",
                "font_size": "36",
                "text_align": "left"
            }
        },
        {
            "id": 2967607837121566,
            "layout": {
                "x": 163,
                "y": 8,
                "width": 31,
                "height": 10
            },
            "definition": {
                "title": "# Requests blocked",
                "title_size": "16",
                "title_align": "left",
                "type": "query_value",
                "requests": [
                    {
                        "aggregator": "avg",
                        "conditional_formats": [
                            {
                                "comparator": ">=",
                                "palette": "white_on_red",
                                "value": 1000
                            },
                            {
                                "comparator": ">=",
                                "palette": "white_on_yellow",
                                "value": 100
                            },
                            {
                                "comparator": ">=",
                                "palette": "black_on_light_yellow",
                                "value": 10
                            },
                            {
                                "comparator": "<",
                                "palette": "yellow_on_white",
                                "value": 10
                            }
                        ],
                        "log_query": {
                            "index": "*",
                            "search": {
                                "query": "@sqreen.context.response.blocked:true $service $env"
                            },
                            "group_by": [],
                            "compute": {
                                "aggregation": "count"
                            }
                        }
                    }
                ],
                "autoscale": true,
                "custom_unit": "reqs",
                "precision": 2
            }
        },
        {
            "id": 950412576849324,
            "layout": {
                "x": 163,
                "y": 19,
                "width": 31,
                "height": 9
            },
            "definition": {
                "type": "note",
                "content": "[Go to security activity](https://my.sqreen.com/security-activity)",
                "background_color": "gray",
                "font_size": "18",
                "text_align": "left",
                "vertical_align": "center",
                "show_tick": false,
                "tick_pos": "50%",
                "tick_edge": "left",
                "has_padding": true
            }
        },
        {
            "id": 3320240675726446,
            "layout": {
                "x": 118,
                "y": 72,
                "width": 77,
                "height": 15
            },
            "definition": {
                "title": "Top 5 Playbooks",
                "title_size": "16",
                "title_align": "left",
                "type": "toplist",
                "requests": [
                    {
                        "log_query": {
                            "index": "*",
                            "search": {
                                "query": "$env $service"
                            },
                            "group_by": [
                                {
                                    "facet": "@sqreen.payload.name",
                                    "sort": {
                                        "order": "desc",
                                        "aggregation": "count"
                                    },
                                    "limit": 5
                                }
                            ],
                            "compute": {
                                "aggregation": "count"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": 7831594966086254,
            "layout": {
                "x": 118,
                "y": 4,
                "width": 76,
                "height": 3
            },
            "definition": {
                "type": "free_text",
                "text": "Env: $env.value | Service: $service.value | Actor: $actor.value | Geo: $geo.value",
                "color": "#4d4d4d",
                "font_size": "16",
                "text_align": "left"
            }
        },
        {
            "id": 8017501743734222,
            "layout": {
                "x": 118,
                "y": 8,
                "width": 44,
                "height": 15
            },
            "definition": {
                "title": "Security incidents detected by Sqreen",
                "title_size": "16",
                "title_align": "left",
                "show_legend": true,
                "legend_layout": "auto",
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "type": "timeseries",
                "requests": [
                    {
                        "on_right_yaxis": false,
                        "security_query": {
                            "index": "*",
                            "search": {
                                "query": "@workflow.rule.name:\"Security Incident detected by Sqreen\" status:(critical OR high)"
                            },
                            "group_by": [],
                            "compute": {
                                "aggregation": "count"
                            }
                        },
                        "style": {
                            "palette": "warm",
                            "line_type": "solid",
                            "line_width": "normal"
                        },
                        "display_type": "bars"
                    }
                ],
                "yaxis": {
                    "scale": "linear",
                    "label": "",
                    "include_zero": true,
                    "min": "auto",
                    "max": "auto"
                },
                "markers": []
            }
        }
    ],
    "template_variables": [
        {
            "name": "env",
            "default": "*",
            "prefix": "env"
        },
        {
            "name": "service",
            "default": "*",
            "prefix": "service"
        },
        {
            "name": "actor",
            "default": "*",
            "prefix": "@usr.id"
        },
        {
            "name": "geo",
            "default": "*",
            "prefix": "@network.client.geoip.country.name"
        }
    ],
    "layout_type": "free",
    "is_read_only": false,
    "notify_list": [],
    "template_variable_presets": [
        {
            "name": "Production",
            "template_variables": [
                {
                    "name": "env",
                    "value": "production"
                }
            ]
        }
    ],
    "id": "d3g-jqp-rf8"
}